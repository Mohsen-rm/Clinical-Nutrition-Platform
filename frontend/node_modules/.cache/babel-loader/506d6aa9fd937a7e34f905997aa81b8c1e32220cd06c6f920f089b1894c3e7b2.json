{"ast":null,"code":"import { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\nconst useAuthStore = create(persist((set, get) => ({\n  user: null,\n  isAuthenticated: false,\n  isLoading: false,\n  isInitialized: false,\n  setUser: user => set({\n    user,\n    isAuthenticated: !!user,\n    isInitialized: true\n  }),\n  setLoading: isLoading => set({\n    isLoading\n  }),\n  setInitialized: isInitialized => set({\n    isInitialized\n  }),\n  login: (userData, tokens) => {\n    localStorage.setItem('access_token', tokens.access);\n    localStorage.setItem('refresh_token', tokens.refresh);\n    set({\n      user: userData,\n      isAuthenticated: true,\n      isLoading: false,\n      isInitialized: true\n    });\n  },\n  logout: () => {\n    localStorage.removeItem('access_token');\n    localStorage.removeItem('refresh_token');\n    set({\n      user: null,\n      isAuthenticated: false,\n      isLoading: false,\n      isInitialized: true\n    });\n  },\n  updateUser: userData => set({\n    user: userData\n  }),\n  // Check if token exists and is potentially valid\n  hasValidToken: () => {\n    const token = localStorage.getItem('access_token');\n    const refreshToken = localStorage.getItem('refresh_token');\n    return !!(token && refreshToken);\n  },\n  // Check if user has active subscription\n  hasActiveSubscription: () => {\n    var _user$subscription;\n    const {\n      user\n    } = get();\n    return (user === null || user === void 0 ? void 0 : (_user$subscription = user.subscription) === null || _user$subscription === void 0 ? void 0 : _user$subscription.is_active) || false;\n  },\n  // Check if user is doctor\n  isDoctor: () => {\n    const {\n      user\n    } = get();\n    return (user === null || user === void 0 ? void 0 : user.user_type) === 'doctor';\n  },\n  // Check if user is patient\n  isPatient: () => {\n    const {\n      user\n    } = get();\n    return (user === null || user === void 0 ? void 0 : user.user_type) === 'patient';\n  }\n}), {\n  name: 'auth-storage',\n  partialize: state => ({\n    user: state.user,\n    isAuthenticated: state.isAuthenticated,\n    isInitialized: state.isInitialized\n  })\n}));\nexport default useAuthStore;","map":{"version":3,"names":["create","persist","useAuthStore","set","get","user","isAuthenticated","isLoading","isInitialized","setUser","setLoading","setInitialized","login","userData","tokens","localStorage","setItem","access","refresh","logout","removeItem","updateUser","hasValidToken","token","getItem","refreshToken","hasActiveSubscription","_user$subscription","subscription","is_active","isDoctor","user_type","isPatient","name","partialize","state"],"sources":["/Users/mohsen/Desktop/Clinical_Nutrition_Platform/frontend/src/store/authStore.js"],"sourcesContent":["import { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\n\nconst useAuthStore = create(\n  persist(\n    (set, get) => ({\n      user: null,\n      isAuthenticated: false,\n      isLoading: false,\n      isInitialized: false,\n\n      setUser: (user) => set({ \n        user, \n        isAuthenticated: !!user,\n        isInitialized: true \n      }),\n      \n      setLoading: (isLoading) => set({ isLoading }),\n\n      setInitialized: (isInitialized) => set({ isInitialized }),\n\n      login: (userData, tokens) => {\n        localStorage.setItem('access_token', tokens.access);\n        localStorage.setItem('refresh_token', tokens.refresh);\n        set({ \n          user: userData, \n          isAuthenticated: true,\n          isLoading: false,\n          isInitialized: true\n        });\n      },\n\n      logout: () => {\n        localStorage.removeItem('access_token');\n        localStorage.removeItem('refresh_token');\n        set({ \n          user: null, \n          isAuthenticated: false,\n          isLoading: false,\n          isInitialized: true\n        });\n      },\n\n      updateUser: (userData) => set({ user: userData }),\n\n      // Check if token exists and is potentially valid\n      hasValidToken: () => {\n        const token = localStorage.getItem('access_token');\n        const refreshToken = localStorage.getItem('refresh_token');\n        return !!(token && refreshToken);\n      },\n\n      // Check if user has active subscription\n      hasActiveSubscription: () => {\n        const { user } = get();\n        return user?.subscription?.is_active || false;\n      },\n\n      // Check if user is doctor\n      isDoctor: () => {\n        const { user } = get();\n        return user?.user_type === 'doctor';\n      },\n\n      // Check if user is patient\n      isPatient: () => {\n        const { user } = get();\n        return user?.user_type === 'patient';\n      },\n    }),\n    {\n      name: 'auth-storage',\n      partialize: (state) => ({\n        user: state.user,\n        isAuthenticated: state.isAuthenticated,\n        isInitialized: state.isInitialized,\n      }),\n    }\n  )\n);\n\nexport default useAuthStore;\n"],"mappings":"AAAA,SAASA,MAAM,QAAQ,SAAS;AAChC,SAASC,OAAO,QAAQ,oBAAoB;AAE5C,MAAMC,YAAY,GAAGF,MAAM,CACzBC,OAAO,CACL,CAACE,GAAG,EAAEC,GAAG,MAAM;EACbC,IAAI,EAAE,IAAI;EACVC,eAAe,EAAE,KAAK;EACtBC,SAAS,EAAE,KAAK;EAChBC,aAAa,EAAE,KAAK;EAEpBC,OAAO,EAAGJ,IAAI,IAAKF,GAAG,CAAC;IACrBE,IAAI;IACJC,eAAe,EAAE,CAAC,CAACD,IAAI;IACvBG,aAAa,EAAE;EACjB,CAAC,CAAC;EAEFE,UAAU,EAAGH,SAAS,IAAKJ,GAAG,CAAC;IAAEI;EAAU,CAAC,CAAC;EAE7CI,cAAc,EAAGH,aAAa,IAAKL,GAAG,CAAC;IAAEK;EAAc,CAAC,CAAC;EAEzDI,KAAK,EAAEA,CAACC,QAAQ,EAAEC,MAAM,KAAK;IAC3BC,YAAY,CAACC,OAAO,CAAC,cAAc,EAAEF,MAAM,CAACG,MAAM,CAAC;IACnDF,YAAY,CAACC,OAAO,CAAC,eAAe,EAAEF,MAAM,CAACI,OAAO,CAAC;IACrDf,GAAG,CAAC;MACFE,IAAI,EAAEQ,QAAQ;MACdP,eAAe,EAAE,IAAI;MACrBC,SAAS,EAAE,KAAK;MAChBC,aAAa,EAAE;IACjB,CAAC,CAAC;EACJ,CAAC;EAEDW,MAAM,EAAEA,CAAA,KAAM;IACZJ,YAAY,CAACK,UAAU,CAAC,cAAc,CAAC;IACvCL,YAAY,CAACK,UAAU,CAAC,eAAe,CAAC;IACxCjB,GAAG,CAAC;MACFE,IAAI,EAAE,IAAI;MACVC,eAAe,EAAE,KAAK;MACtBC,SAAS,EAAE,KAAK;MAChBC,aAAa,EAAE;IACjB,CAAC,CAAC;EACJ,CAAC;EAEDa,UAAU,EAAGR,QAAQ,IAAKV,GAAG,CAAC;IAAEE,IAAI,EAAEQ;EAAS,CAAC,CAAC;EAEjD;EACAS,aAAa,EAAEA,CAAA,KAAM;IACnB,MAAMC,KAAK,GAAGR,YAAY,CAACS,OAAO,CAAC,cAAc,CAAC;IAClD,MAAMC,YAAY,GAAGV,YAAY,CAACS,OAAO,CAAC,eAAe,CAAC;IAC1D,OAAO,CAAC,EAAED,KAAK,IAAIE,YAAY,CAAC;EAClC,CAAC;EAED;EACAC,qBAAqB,EAAEA,CAAA,KAAM;IAAA,IAAAC,kBAAA;IAC3B,MAAM;MAAEtB;IAAK,CAAC,GAAGD,GAAG,CAAC,CAAC;IACtB,OAAO,CAAAC,IAAI,aAAJA,IAAI,wBAAAsB,kBAAA,GAAJtB,IAAI,CAAEuB,YAAY,cAAAD,kBAAA,uBAAlBA,kBAAA,CAAoBE,SAAS,KAAI,KAAK;EAC/C,CAAC;EAED;EACAC,QAAQ,EAAEA,CAAA,KAAM;IACd,MAAM;MAAEzB;IAAK,CAAC,GAAGD,GAAG,CAAC,CAAC;IACtB,OAAO,CAAAC,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAE0B,SAAS,MAAK,QAAQ;EACrC,CAAC;EAED;EACAC,SAAS,EAAEA,CAAA,KAAM;IACf,MAAM;MAAE3B;IAAK,CAAC,GAAGD,GAAG,CAAC,CAAC;IACtB,OAAO,CAAAC,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAE0B,SAAS,MAAK,SAAS;EACtC;AACF,CAAC,CAAC,EACF;EACEE,IAAI,EAAE,cAAc;EACpBC,UAAU,EAAGC,KAAK,KAAM;IACtB9B,IAAI,EAAE8B,KAAK,CAAC9B,IAAI;IAChBC,eAAe,EAAE6B,KAAK,CAAC7B,eAAe;IACtCE,aAAa,EAAE2B,KAAK,CAAC3B;EACvB,CAAC;AACH,CACF,CACF,CAAC;AAED,eAAeN,YAAY","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}