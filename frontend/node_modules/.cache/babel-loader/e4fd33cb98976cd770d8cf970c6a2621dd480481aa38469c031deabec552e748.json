{"ast":null,"code":"import useAuthStore from '../store/authStore';\nexport const clearAuthData = () => {\n  // Clear localStorage\n  localStorage.removeItem('access_token');\n  localStorage.removeItem('refresh_token');\n\n  // Clear Zustand state\n  useAuthStore.getState().logout();\n\n  // Clear any persisted data\n  localStorage.removeItem('auth-storage');\n};\nexport const forceReauth = () => {\n  clearAuthData();\n  window.location.href = '/login';\n};\nexport const isTokenExpired = token => {\n  if (!token) return true;\n  try {\n    const payload = JSON.parse(atob(token.split('.')[1]));\n    const currentTime = Date.now() / 1000;\n    return payload.exp < currentTime;\n  } catch (error) {\n    return true;\n  }\n};","map":{"version":3,"names":["useAuthStore","clearAuthData","localStorage","removeItem","getState","logout","forceReauth","window","location","href","isTokenExpired","token","payload","JSON","parse","atob","split","currentTime","Date","now","exp","error"],"sources":["/Users/mohsen/Desktop/Clinical_Nutrition_Platform/frontend/src/utils/auth.js"],"sourcesContent":["import useAuthStore from '../store/authStore';\n\nexport const clearAuthData = () => {\n  // Clear localStorage\n  localStorage.removeItem('access_token');\n  localStorage.removeItem('refresh_token');\n  \n  // Clear Zustand state\n  useAuthStore.getState().logout();\n  \n  // Clear any persisted data\n  localStorage.removeItem('auth-storage');\n};\n\nexport const forceReauth = () => {\n  clearAuthData();\n  window.location.href = '/login';\n};\n\nexport const isTokenExpired = (token) => {\n  if (!token) return true;\n  \n  try {\n    const payload = JSON.parse(atob(token.split('.')[1]));\n    const currentTime = Date.now() / 1000;\n    return payload.exp < currentTime;\n  } catch (error) {\n    return true;\n  }\n};\n"],"mappings":"AAAA,OAAOA,YAAY,MAAM,oBAAoB;AAE7C,OAAO,MAAMC,aAAa,GAAGA,CAAA,KAAM;EACjC;EACAC,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC;EACvCD,YAAY,CAACC,UAAU,CAAC,eAAe,CAAC;;EAExC;EACAH,YAAY,CAACI,QAAQ,CAAC,CAAC,CAACC,MAAM,CAAC,CAAC;;EAEhC;EACAH,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC;AACzC,CAAC;AAED,OAAO,MAAMG,WAAW,GAAGA,CAAA,KAAM;EAC/BL,aAAa,CAAC,CAAC;EACfM,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;AACjC,CAAC;AAED,OAAO,MAAMC,cAAc,GAAIC,KAAK,IAAK;EACvC,IAAI,CAACA,KAAK,EAAE,OAAO,IAAI;EAEvB,IAAI;IACF,MAAMC,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACJ,KAAK,CAACK,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACrD,MAAMC,WAAW,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IAAI;IACrC,OAAOP,OAAO,CAACQ,GAAG,GAAGH,WAAW;EAClC,CAAC,CAAC,OAAOI,KAAK,EAAE;IACd,OAAO,IAAI;EACb;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}