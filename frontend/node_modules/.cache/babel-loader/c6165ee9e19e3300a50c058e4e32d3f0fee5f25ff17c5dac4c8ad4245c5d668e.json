{"ast":null,"code":"import useAuthStore from '../store/authStore';\nexport const clearAuthData = () => {\n  // Clear localStorage\n  localStorage.removeItem('access_token');\n  localStorage.removeItem('refresh_token');\n\n  // Clear Zustand state\n  useAuthStore.getState().logout();\n\n  // Clear any persisted data\n  localStorage.removeItem('auth-storage');\n};\nexport const getStoredCredentials = () => {\n  try {\n    const stored = localStorage.getItem('temp_credentials');\n    return stored ? JSON.parse(stored) : null;\n  } catch {\n    return null;\n  }\n};\nexport const storeCredentials = (email, password) => {\n  // Store temporarily for auto re-login (remove in production)\n  localStorage.setItem('temp_credentials', JSON.stringify({\n    email,\n    password\n  }));\n};\nexport const clearStoredCredentials = () => {\n  localStorage.removeItem('temp_credentials');\n};\nexport const forceReauth = () => {\n  clearAuthData();\n  window.location.href = '/login';\n};\nexport const isTokenExpired = token => {\n  if (!token) return true;\n  try {\n    const payload = JSON.parse(atob(token.split('.')[1]));\n    const currentTime = Date.now() / 1000;\n    return payload.exp < currentTime;\n  } catch (error) {\n    return true;\n  }\n};","map":{"version":3,"names":["useAuthStore","clearAuthData","localStorage","removeItem","getState","logout","getStoredCredentials","stored","getItem","JSON","parse","storeCredentials","email","password","setItem","stringify","clearStoredCredentials","forceReauth","window","location","href","isTokenExpired","token","payload","atob","split","currentTime","Date","now","exp","error"],"sources":["/Users/mohsen/Desktop/Clinical_Nutrition_Platform/frontend/src/utils/auth.js"],"sourcesContent":["import useAuthStore from '../store/authStore';\n\nexport const clearAuthData = () => {\n  // Clear localStorage\n  localStorage.removeItem('access_token');\n  localStorage.removeItem('refresh_token');\n  \n  // Clear Zustand state\n  useAuthStore.getState().logout();\n  \n  // Clear any persisted data\n  localStorage.removeItem('auth-storage');\n};\n\nexport const getStoredCredentials = () => {\n  try {\n    const stored = localStorage.getItem('temp_credentials');\n    return stored ? JSON.parse(stored) : null;\n  } catch {\n    return null;\n  }\n};\n\nexport const storeCredentials = (email, password) => {\n  // Store temporarily for auto re-login (remove in production)\n  localStorage.setItem('temp_credentials', JSON.stringify({ email, password }));\n};\n\nexport const clearStoredCredentials = () => {\n  localStorage.removeItem('temp_credentials');\n};\n\nexport const forceReauth = () => {\n  clearAuthData();\n  window.location.href = '/login';\n};\n\nexport const isTokenExpired = (token) => {\n  if (!token) return true;\n  \n  try {\n    const payload = JSON.parse(atob(token.split('.')[1]));\n    const currentTime = Date.now() / 1000;\n    return payload.exp < currentTime;\n  } catch (error) {\n    return true;\n  }\n};\n"],"mappings":"AAAA,OAAOA,YAAY,MAAM,oBAAoB;AAE7C,OAAO,MAAMC,aAAa,GAAGA,CAAA,KAAM;EACjC;EACAC,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC;EACvCD,YAAY,CAACC,UAAU,CAAC,eAAe,CAAC;;EAExC;EACAH,YAAY,CAACI,QAAQ,CAAC,CAAC,CAACC,MAAM,CAAC,CAAC;;EAEhC;EACAH,YAAY,CAACC,UAAU,CAAC,cAAc,CAAC;AACzC,CAAC;AAED,OAAO,MAAMG,oBAAoB,GAAGA,CAAA,KAAM;EACxC,IAAI;IACF,MAAMC,MAAM,GAAGL,YAAY,CAACM,OAAO,CAAC,kBAAkB,CAAC;IACvD,OAAOD,MAAM,GAAGE,IAAI,CAACC,KAAK,CAACH,MAAM,CAAC,GAAG,IAAI;EAC3C,CAAC,CAAC,MAAM;IACN,OAAO,IAAI;EACb;AACF,CAAC;AAED,OAAO,MAAMI,gBAAgB,GAAGA,CAACC,KAAK,EAAEC,QAAQ,KAAK;EACnD;EACAX,YAAY,CAACY,OAAO,CAAC,kBAAkB,EAAEL,IAAI,CAACM,SAAS,CAAC;IAAEH,KAAK;IAAEC;EAAS,CAAC,CAAC,CAAC;AAC/E,CAAC;AAED,OAAO,MAAMG,sBAAsB,GAAGA,CAAA,KAAM;EAC1Cd,YAAY,CAACC,UAAU,CAAC,kBAAkB,CAAC;AAC7C,CAAC;AAED,OAAO,MAAMc,WAAW,GAAGA,CAAA,KAAM;EAC/BhB,aAAa,CAAC,CAAC;EACfiB,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAG,QAAQ;AACjC,CAAC;AAED,OAAO,MAAMC,cAAc,GAAIC,KAAK,IAAK;EACvC,IAAI,CAACA,KAAK,EAAE,OAAO,IAAI;EAEvB,IAAI;IACF,MAAMC,OAAO,GAAGd,IAAI,CAACC,KAAK,CAACc,IAAI,CAACF,KAAK,CAACG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACrD,MAAMC,WAAW,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IAAI;IACrC,OAAOL,OAAO,CAACM,GAAG,GAAGH,WAAW;EAClC,CAAC,CAAC,OAAOI,KAAK,EAAE;IACd,OAAO,IAAI;EACb;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}